sudo bash -lc '
fail=0
echo "Checking /var/log (top-level files) ...";
for f in /var/log/* /var/log/.*; do
  [ -f "$f" ] || continue
  bn=$(basename "$f")
  mode=$(stat -c "%a" "$f" 2>/dev/null || echo "000")
  owner=$(stat -c "%U" "$f" 2>/dev/null || echo "?")
  group=$(stat -c "%G" "$f" 2>/dev/null || echo "?")

  case "$bn" in
    lastlog | lastlog.* | wtmp | wtmp.* | wtmp-* | btmp | btmp.* | btmp-*)
      max=0664; want_owners="root"; want_groups="root"; ;;
    secure|auth.log|syslog|messages|*.journal|.*journal~)
      max=0640; want_owners="root|syslog"; want_groups="root|adm|systemd-journal"; ;;
    gdm|gdm3|SSSD|sssd)
      max=0660; want_owners="root|sssd"; want_groups="root|sssd|gdm|gdm3"; ;;
    *)
      max=0640; want_owners="root|syslog"; want_groups="root|adm"; ;;
  esac

  # owner check
  if ! printf "%s\n" "$want_owners" | grep -Eq "^(${owner//|/|})$"; then
    echo "BAD_OWNER: $f owner=$owner expected one-of: ${want_owners//|/, }"; fail=1
  fi

  # group check
  if ! printf "%s\n" "$want_groups" | grep -Eq "^(${group//|/|})$"; then
    echo "BAD_GROUP: $f group=$group expected one-of: ${want_groups//|/, }"; fail=1
  fi

  # mode check: ensure no bits outside max are set
  if (( (8#$mode & ~(8#$max)) != 0 )); then
    echo "BAD_MODE:  $f mode=$mode should be $max or more restrictive"; fail=1
  fi
done

if [ $fail -eq 0 ]; then echo "PASS: /var/log files meet checked criteria"; else echo "FAIL: see items above"; fi
'
